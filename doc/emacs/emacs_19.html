<!-- This HTML file has been created by texi2html 1.27
     from emacs.texi on 3 March 1994 -->

<TITLE>GNU Emacs Manual - File Handling</TITLE>
<P>Go to the <A HREF="emacs_18.html">previous</A>, <A HREF="emacs_20.html">next</A> section.<P>
<A NAME="IDX426"></A>
<H1><A NAME="SEC96" HREF="emacs_toc.html#SEC96">File Handling</A></H1>
<P>
  The basic unit of stored data in Unix is the <DFN>file</DFN>.  To edit a file,
you must tell Emacs to examine the file and prepare a buffer containing a
copy of the file's text.  This is called <DFN>visiting</DFN> the file.  Editing
commands apply directly to text in the buffer; that is, to the copy inside
Emacs.  Your changes appear in the file itself only when you <DFN>save</DFN> the
buffer back into the file.
<P>
  In addition to visiting and saving files, Emacs can delete, copy,
rename, and append to files, keep multiple versions of them, and operate
on file directories.
<P>
<A NAME="IDX427"></A>
<H2><A NAME="SEC97" HREF="emacs_toc.html#SEC97">File Names</A></H2>
<P>
  Most Emacs commands that operate on a file require you to specify the
file name.  (Saving and reverting are exceptions; the buffer knows which
file name to use for them.)  You enter the file name using the
minibuffer (see section <A HREF="emacs_10.html#SEC30">The Minibuffer</A>).  <DFN>Completion</DFN> is available, to make
it easier to specify long file names.  See section <A HREF="emacs_10.html#SEC33">Completion</A>.
<P>
  For most operations, there is a <DFN>default file name</DFN> which is used
if you type just <KBD>RET</KBD> to enter an empty argument.  Normally the
default file name is the name of the file visited in the current buffer;
this makes it easy to operate on that file with any of the Emacs file
commands.
<A NAME="IDX428"></A>
<P>
  Each buffer has a default directory, normally the same as the
directory of the file visited in that buffer.  When you enter a file
name without a directory, the default directory is used.  If you specify
a directory in a relative fashion, with a name that does not start with
a slash, it is interpreted with respect to the default directory.  The
default directory is kept in the variable <CODE>default-directory</CODE>,
which has a separate value in every buffer.
<P>
  For example, if the default file name is <TT>`/u/rms/gnu/gnu.tasks'</TT> then
the default directory is <TT>`/u/rms/gnu/'</TT>.  If you type just <SAMP>`foo'</SAMP>,
which does not specify a directory, it is short for <TT>`/u/rms/gnu/foo'</TT>.
<SAMP>`../.login'</SAMP> would stand for <TT>`/u/rms/.login'</TT>.  <SAMP>`new/foo'</SAMP>
would stand for the file name <TT>`/u/rms/gnu/new/foo'</TT>.
<P>
  The command <KBD>M-x pwd</KBD> prints the current buffer's default
directory, and the command <KBD>M-x cd</KBD> sets it (to a value read using
the minibuffer).  A buffer's default directory changes only when the
<CODE>cd</CODE> command is used.  A file-visiting buffer's default directory
is initialized to the directory of the file that is visited there.  If
you create a buffer with <KBD>C-x b</KBD>, its default directory is copied
from that of the buffer that was current at the time.
<A NAME="IDX429"></A>
<P>
  The default directory actually appears in the minibuffer when the
minibuffer becomes active to read a file name.  This serves two
purposes: it <EM>shows</EM> you what the default is, so that you can type
a relative file name and know with certainty what it will mean, and it
allows you to <EM>edit</EM> the default to specify a different directory.
This insertion of the default directory is inhibited if the variable
<CODE>insert-default-directory</CODE> is set to <CODE>nil</CODE>.
<P>
  Note that it is legitimate to type an absolute file name after you
enter the minibuffer, ignoring the presence of the default directory
name as part of the text.  The final minibuffer contents may look
invalid, but that is not so.  For example, if the minibuffer starts out
with <SAMP>`/usr/tmp/'</SAMP> and you add <SAMP>`/x1/rms/foo'</SAMP>, the double slash
says to ignore the default directory and use just the name that you
typed.  See section <A HREF="emacs_10.html#SEC31">Minibuffers for File Names</A>.
<A NAME="IDX430"></A>
<A NAME="IDX431"></A>
<P>
  You can refer to files on other machines using a special file name syntax:
<P>
<PRE>
/<VAR>host</VAR>:<VAR>filename</VAR>
/<VAR>user</VAR>@<VAR>host</VAR>:<VAR>filename</VAR>
</PRE>
<P>
  When you do this, Emacs uses the FTP program to read and write files
on the specified host.  It logs in through FTP using your user name or
the name <VAR>user</VAR>.  It may ask you for a password from time to time;
this is used for logging in on <VAR>host</VAR>.
<P>
  <SAMP>`$'</SAMP> in a file name is used to substitute environment variables.  For
example, if you have used the shell command <SAMP>`setenv FOO rms/hacks'</SAMP> to
set up an environment variable named <SAMP>`FOO'</SAMP>, then you can use
<TT>`/u/$FOO/test.c'</TT> or <TT>`/u/${FOO}/test.c'</TT> as an abbreviation for
<TT>`/u/rms/hacks/test.c'</TT>.  The environment variable name consists of all
the alphanumeric characters after the <SAMP>`$'</SAMP>; alternatively, it may be
enclosed in braces after the <SAMP>`$'</SAMP>.  Note that the <SAMP>`setenv'</SAMP> command
affects Emacs only if done before Emacs is started.
<P>
  To access a file with <SAMP>`$'</SAMP> in its name, type <SAMP>`$$'</SAMP>.  This pair
is converted to a single <SAMP>`$'</SAMP> at the same time as variable substitution
is performed for single <SAMP>`$'</SAMP>.  The Lisp function that performs the
substitution is called <CODE>substitute-in-file-name</CODE>.  The substitution
is performed only on file names read as such using the minibuffer.
<P>
<A NAME="IDX432"></A>
<H2><A NAME="SEC98" HREF="emacs_toc.html#SEC98">Visiting Files</A></H2>
<P>
<DL COMPACT>
<DT><KBD>C-x C-f</KBD>
<DD>Visit a file (<CODE>find-file</CODE>).
<DT><KBD>C-x C-r</KBD>
<DD>Visit a file for viewing, without allowing changes to it
(<CODE>find-file-read-only</CODE>).
<DT><KBD>C-x C-v</KBD>
<DD>Visit a different file instead of the one visited last
(<CODE>find-alternate-file</CODE>).
<DT><KBD>C-x 4 C-f</KBD>
<DD>Visit a file, in another window (<CODE>find-file-other-window</CODE>).  Don't
change the selected window.
<DT><KBD>C-x 5 C-f</KBD>
<DD>Visit a file, in a new frame (<CODE>find-file-other-frame</CODE>).  Don't
change the selected frame.
</DL>
<A NAME="IDX433"></A>
<A NAME="IDX434"></A>
<A NAME="IDX435"></A>
<P>
  <DFN>Visiting</DFN> a file means copying its contents into an Emacs buffer
so you can edit them.  Emacs makes a new buffer for each file that you
visit.  We say that this buffer is visiting the file that it was created
to hold.  Emacs constructs the buffer name from the file name by
throwing away the directory, keeping just the name proper.  For example,
a file named <TT>`/usr/rms/emacs.tex'</TT> would get a buffer named
<SAMP>`emacs.tex'</SAMP>.  If there is already a buffer with that name, a unique
name is constructed by appending <SAMP>`&#60;2&#62;'</SAMP>, <SAMP>`&#60;3&#62;'</SAMP>, or so on, using
the lowest number that makes a name that is not already in use.
<P>
  Each window's mode line shows the name of the buffer that is being displayed
in that window, so you can always tell what buffer you are editing.
<P>
  The changes you make with Emacs are made in the Emacs buffer.  They do
not take effect in the file that you visited, or any place permanent, until
you <DFN>save</DFN> the buffer.  Saving the buffer means that Emacs writes the
current contents of the buffer into its visited file.  See section <A HREF="emacs_19.html#SEC99">Saving Files</A>.
<A NAME="IDX436"></A>
<P>
  If a buffer contains changes that have not been saved, we say the
buffer is <DFN>modified</DFN>.  This is important because it implies that
some changes will be lost if the buffer is not saved.  The mode line
displays two stars near the left margin to indicate that the buffer is
modified.
<A NAME="IDX437"></A>
<A NAME="IDX438"></A>
<P>
  To visit a file, use the command <KBD>C-x C-f</KBD> (<CODE>find-file</CODE>).  Follow
the command with the name of the file you wish to visit, terminated by a
<KBD>RET</KBD>.
<P>
  The file name is read using the minibuffer (see section <A HREF="emacs_10.html#SEC30">The Minibuffer</A>), with
defaulting and completion in the standard manner (see section <A HREF="emacs_19.html#SEC97">File Names</A>).
While in the minibuffer, you can abort <KBD>C-x C-f</KBD> by typing <KBD>C-g</KBD>.
<P>
  Your confirmation that <KBD>C-x C-f</KBD> has completed successfully is the
appearance of new text on the screen and a new buffer name in the mode
line.  If the specified file does not exist and could not be created, or
cannot be read, then you get an error, with an error message displayed
in the echo area.
<P>
  If you visit a file that is already in Emacs, <KBD>C-x C-f</KBD> does not make
another copy.  It selects the existing buffer containing that file.
However, before doing so, it checks that the file itself has not changed
since you visited or saved it last.  If the file has changed, a warning
message is printed.  See section <A HREF="emacs_19.html#SEC104">Protection against Simultaneous Editing</A>.
<A NAME="IDX439"></A>
<P>
  What if you want to create a new file?  Just visit it.  Emacs prints
<SAMP>`(New File)'</SAMP> in the echo area, but in other respects behaves as if
you had visited an existing empty file.  If you make any changes and
save them, the file is created.
<A NAME="IDX440"></A>
<P>
  If the file you specify is actually a directory, Dired is called on that
directory (see section <A HREF="emacs_32.html#SEC269">Dired, the Directory Editor</A>).  This can be inhibited by setting the variable
<CODE>find-file-run-dired</CODE> to <CODE>nil</CODE>; then it is an error to try to
visit a directory.
<P>
  If you visit a file that the operating system won't let you modify,
Emacs makes the buffer read-only, so that you won't go ahead and make
changes that you'll have trouble saving afterward.  You can make the
buffer writable with <KBD>C-x C-q</KBD> (<CODE>toggle-read-only</CODE>).
See section <A HREF="emacs_20.html#SEC130">Miscellaneous Buffer Operations</A>.
<A NAME="IDX441"></A>
<A NAME="IDX442"></A>
<P>
  Occasionally you might want to visit a file as read-only in order to
protect yourself from entering changes accidentally; do so by visiting
the file with the command <KBD>C-x C-r</KBD> (<CODE>find-file-read-only</CODE>).
<A NAME="IDX443"></A>
<A NAME="IDX444"></A>
<P>
  If you visit a nonexistent file unintentionally (because you typed the
wrong file name), use the <KBD>C-x C-v</KBD> command
(<CODE>find-alternate-file</CODE>) to visit the file you really wanted.
<KBD>C-x C-v</KBD> is similar to <KBD>C-x C-f</KBD>, but it kills the current
buffer (after first offering to save it if it is modified).  When it
reads the file name to visit, it inserts the entire default file name in
the buffer, with point just after the directory part; this is convenient
if you made a slight error in typing the name.
<A NAME="IDX445"></A>
<A NAME="IDX446"></A>
<P>
  <KBD>C-x 4 f</KBD> (<CODE>find-file-other-window</CODE>) is like <KBD>C-x C-f</KBD>
except that the buffer containing the specified file is selected in another
window.  The window that was selected before <KBD>C-x 4 f</KBD> continues to
show the same buffer it was already showing.  If this command is used when
only one window is being displayed, that window is split in two, with one
window showing the same buffer as before, and the other one showing the
newly requested file.  See section <A HREF="emacs_21.html#SEC133">Multiple Windows</A>.
<A NAME="IDX447"></A>
<A NAME="IDX448"></A>
<P>
  <KBD>C-x 5 f</KBD> (<CODE>find-file-other-frame</CODE>) is similar, but opens a
new frame.  This feature is available only when you are using a window
system.  See section <A HREF="emacs_22.html#SEC139">Frames and X Windows</A>.
<A NAME="IDX449"></A>
<A NAME="IDX450"></A>
<P>
  Two special hook variables allow extensions to modify the operation of
visiting files.  Visiting a file that does not exist runs the functions
in the list <CODE>find-file-not-found-hooks</CODE>; this variable holds a list
of functions, and the functions are called one by one until one of them
returns non-<CODE>nil</CODE>.  Any visiting of a file, whether extant or not,
expects <CODE>find-file-hooks</CODE> to contain a list of functions and calls
them all, one by one.  In both cases the functions receive no
arguments.  Of these two variables, <CODE>find-file-not-found-hooks</CODE>
takes effect first.  These variables are <EM>not</EM> normal hooks, and
their names end in <SAMP>`-hooks'</SAMP> rather than <SAMP>`-hook'</SAMP> to indicate
that fact.
<P>
  There are several ways to specify automatically the major mode for
editing the file (see section <A HREF="emacs_23.html#SEC150">How Major Modes are Chosen</A>), and to specify local
variables defined for that file (see section <A HREF="emacs_35.html#SEC339">Local Variables in Files</A>).
<P>
<H2><A NAME="SEC99" HREF="emacs_toc.html#SEC99">Saving Files</A></H2>
<P>
  <DFN>Saving</DFN> a buffer in Emacs means writing its contents back into the file
that was visited in the buffer.
<P>
<DL COMPACT>
<DT><KBD>C-x C-s</KBD>
<DD>Save the current buffer in its visited file (<CODE>save-buffer</CODE>).
<DT><KBD>C-x s</KBD>
<DD>Save any or all buffers in their visited files (<CODE>save-some-buffers</CODE>).
<DT><KBD>M-~</KBD>
<DD>Forget that the current buffer has been changed (<CODE>not-modified</CODE>).
<DT><KBD>C-x C-w</KBD>
<DD>Save the current buffer in a specified file (<CODE>write-file</CODE>).
<DT><KBD>M-x set-visited-file-name</KBD>
<DD>Change file the name under which the current buffer will be saved.
</DL>
<A NAME="IDX451"></A>
<A NAME="IDX452"></A>
<P>
  When you wish to save the file and make your changes permanent, type
<KBD>C-x C-s</KBD> (<CODE>save-buffer</CODE>).  After saving is finished, <KBD>C-x C-s</KBD>
prints a message such as
<P>
<PRE>
Wrote /u/rms/gnu/gnu.tasks
</PRE>
<P>
If the selected buffer is not modified (no changes have been made in it
since the buffer was created or last saved), saving is not really done,
because it would have no effect.  Instead, <KBD>C-x C-s</KBD> prints a message
in the echo area saying
<P>
<PRE>
(No changes need to be written)
</PRE>
<A NAME="IDX453"></A>
<A NAME="IDX454"></A>
<P>
  The command <KBD>C-x s</KBD> (<CODE>save-some-buffers</CODE>) offers to save any
or all modified buffers.  It asks you what to do with each buffer.  The
options are analogous to those of <CODE>query-replace</CODE>:
<P>
<DL COMPACT>
<DT><KBD>y</KBD>
<DD>Save this buffer and ask about the rest of the buffers.
<DT><KBD>n</KBD>
<DD>Don't save this buffer, but ask about the rest of the buffers.
<DT><KBD>!</KBD>
<DD>Save this buffer and all the rest with no more questions.
<DT><KBD><KBD>ESC</KBD></KBD>
<DD>Terminate <CODE>save-some-buffers</CODE> without any more saving.
<DT><KBD>.</KBD>
<DD>Save this buffer, then exit <CODE>save-some-buffers</CODE> without even asking
about other buffers.
<DT><KBD>C-r</KBD>
<DD>View the buffer that you are currently being asked about.  When you exit
View mode, you get back to <CODE>save-some-buffers</CODE>, which asks the
question again.
<DT><KBD>C-h</KBD>
<DD>Display a help message about these options.
</DL>
<P>
  <KBD>C-x C-c</KBD>, the key sequence to exit Emacs, invokes
<CODE>save-some-buffers</CODE> and therefore asks the same questions.
<A NAME="IDX455"></A>
<A NAME="IDX456"></A>
<P>
  If you have changed a buffer and do not want the changes to be saved,
you should take some action to prevent it.  Otherwise, each time you use
<KBD>C-x s</KBD> or <KBD>C-x C-c</KBD>, you are liable to save it by mistake.  One
thing you can do is type <KBD>M-~</KBD> (<CODE>not-modified</CODE>), which clears
out the indication that the buffer is modified.  If you do this, none of
the save commands will believe that the buffer needs to be saved.
(<SAMP>`~'</SAMP> is often used as a mathematical symbol for `not'; thus
<KBD>M-~</KBD> is `not', metafied.)  You could also use
<CODE>set-visited-file-name</CODE> (see below) to mark the buffer as visiting
a different file name, one which is not in use for anything important.
Alternatively, you can cancel all the changes made since the file was
visited or saved, by reading the text from the file again.  This is
called <DFN>reverting</DFN>.  See section <A HREF="emacs_19.html#SEC105">Reverting a Buffer</A>.  You could also undo all the
changes by repeating the undo command <KBD>C-x u</KBD> until you have undone
all the changes; but reverting is easier.
<A NAME="IDX457"></A>
<P>
  <KBD>M-x set-visited-file-name</KBD> alters the name of the file that the
current buffer is visiting.  It reads the new file name using the
minibuffer.  Then it specifies the visited file name and changes the
buffer name correspondingly (as long as the new name is not in use).
<CODE>set-visited-file-name</CODE> does not save the buffer in the newly
visited file; it just alters the records inside Emacs in case you do
save later.  It also marks the buffer as "modified" so that <KBD>C-x
C-s</KBD> in that buffer <EM>will</EM> save.
<A NAME="IDX458"></A>
<A NAME="IDX459"></A>
<P>
  If you wish to mark the buffer as visiting a different file and save it
right away, use <KBD>C-x C-w</KBD> (<CODE>write-file</CODE>).  It is precisely
equivalent to <CODE>set-visited-file-name</CODE> followed by <KBD>C-x C-s</KBD>.
<KBD>C-x C-s</KBD> used on a buffer that is not visiting with a file has the
same effect as <KBD>C-x C-w</KBD>; that is, it reads a file name, marks the
buffer as visiting that file, and saves it there.  The default file name in
a buffer that is not visiting a file is made by combining the buffer name
with the buffer's default directory.
<P>
  If Emacs is about to save a file and sees that the date of the latest
version on disk does not match what Emacs last read or wrote, Emacs
notifies you of this fact, because it probably indicates a problem caused
by simultaneous editing and requires your immediate attention.
See section <A HREF="emacs_19.html#SEC104">Protection against Simultaneous Editing</A>.
<A NAME="IDX460"></A>
<P>
  If the variable <CODE>require-final-newline</CODE> is non-<CODE>nil</CODE>, Emacs
puts a newline at the end of any file that doesn't already end in one,
every time a file is saved or written.
<A NAME="IDX461"></A>
<P>
  You can implement other ways to write files, and other things to be
done before writing them, using the variable
<CODE>write-file-hooks</CODE>.  The value of this variable should be a list of
Lisp functions.  When a file is to be written, the functions in the list
are called, one by one, with no arguments.  If one of them returns a
non-<CODE>nil</CODE> value, Emacs takes this to mean that the file has been
written in some suitable fashion; the rest of the functions are not
called, and normal writing is not done.  If this variable is local to a
buffer, changing major modes does not clear it.  However, changing the
visited file name does clear this variable to <CODE>nil</CODE>.
<A NAME="IDX462"></A>
<P>
  The list <CODE>local-write-file-hooks</CODE> is used just like
<CODE>write-file-hooks</CODE>.  This list is for use as a local variable.  It
is a permanent local, so that switching major modes does not affect it.
<A NAME="IDX463"></A>
<P>
  The variable <CODE>write-contents-hooks</CODE> holds another list of
functions to be called before writing out a buffer to a file.  These
functions are used just like the ones in <CODE>write-file-hooks</CODE>.  The
difference between this and <CODE>write-file-hooks</CODE> is that changing the
major mode does clear this variable, and setting the visited file name
does not clear it.
<P>
  The hook functions are responsible for writing backup files, if you
want that to be done.  Here is how:
<P>
<PRE>
(or buffer-backed-up (backup-buffer))
</PRE>
<P>
You might also wish to save the file modes value returned by
<CODE>backup-buffer</CODE> and use that to set the mode bits of the file
that you write.  This is what happens ordinarily when backups are made.
 
  The hook variables described here are not normal hooks, because the
values returned by the hook functions do matter.  This is why they have
names ending in <SAMP>`-hooks'</SAMP> rather than <SAMP>`-hook'</SAMP>.  See section <A HREF="emacs_35.html#SEC337">Hooks</A>.
<P>
<A NAME="IDX464"></A>
<A NAME="IDX465"></A>
<H3><A NAME="SEC100" HREF="emacs_toc.html#SEC100">Backup Files</A></H3>
<P>
  Because Unix does not provide version numbers in file names, rewriting a
file in Unix automatically destroys all record of what the file used to
contain.  Thus, saving a file from Emacs throws away the old contents of
the file--or it would, except that Emacs carefully copies the old contents
to another file, called the <DFN>backup</DFN> file, before actually saving.
(This assumes that the variable <CODE>make-backup-files</CODE> is non-<CODE>nil</CODE>.
Backup files are not written if this variable is <CODE>nil</CODE>.)
<P>
  At your option, Emacs can keep either a single backup file or a series of
numbered backup files for each file that you edit.
<P>
  Emacs makes a backup for a file only the first time the file is saved
from one buffer.  No matter how many times you save a file, its backup file
continues to contain the contents from before the file was visited.
Normally this means that the backup file contains the contents from before
the current editing session; however, if you kill the buffer and then visit
the file again, a new backup file will be made by the next save.
<P>
<H4><A NAME="SEC101" HREF="emacs_toc.html#SEC101">Single or Numbered Backups</A></H4>
<P>
  If you choose to have a single backup file (this is the default),
the backup file's name is constructed by appending <SAMP>`~'</SAMP> to the
file name being edited; thus, the backup file for <TT>`eval.c'</TT> would
be <TT>`eval.c~'</TT>.
<P>
  If you choose to have a series of numbered backup files, backup file
names are made by appending <SAMP>`.~'</SAMP>, the number, and another <SAMP>`~'</SAMP> to
the original file name.  Thus, the backup files of <TT>`eval.c'</TT> would be
called <TT>`eval.c.~1~'</TT>, <TT>`eval.c.~2~'</TT>, and so on, through names
like <TT>`eval.c.~259~'</TT> and beyond.
<P>
  If protection stops you from writing backup files under the usual names,
the backup file is written as <TT>`%backup%~'</TT> in your home directory.
Only one such file can exist, so only the most recently made such backup is
available.
<A NAME="IDX466"></A>
<P>
  The choice of single backup or numbered backups is controlled by the
variable <CODE>version-control</CODE>.  Its possible values are
<P>
<DL COMPACT>
<DT><CODE>t</CODE>
<DD>Make numbered backups.
<DT><CODE>nil</CODE>
<DD>Make numbered backups for files that have numbered backups already.
Otherwise, make single backups.
<DT><CODE>never</CODE>
<DD>Do not in any case make numbered backups; always make single backups.
</DL>
<P>
You can set <CODE>version-control</CODE> locally in an individual buffer to
control the making of backups for that buffer's file.  For example,
Rmail mode locally sets <CODE>version-control</CODE> to <CODE>never</CODE> to make sure
that there is only one backup for an Rmail file.  See section <A HREF="emacs_35.html#SEC338">Local Variables</A>.
<A NAME="IDX467"></A>
<P>
  If you set the environment variable <CODE>VERSION_CONTROL</CODE>, to tell
various GNU utilities what to do with backup files, Emacs also obeys the
environment variable by setting the Lisp variable <CODE>version-control</CODE>
accordingly at startup.  If the environment variable's value is <SAMP>`t'</SAMP>
or <SAMP>`numbered'</SAMP>, then <CODE>version-control</CODE> becomes <CODE>t</CODE>; if the
value is <SAMP>`nil'</SAMP> or <SAMP>`existing'</SAMP>, then <CODE>version-control</CODE>
becomes <CODE>nil</CODE>; if it is <SAMP>`never'</SAMP> or <SAMP>`simple'</SAMP>, then
<CODE>version-control</CODE> becomes <CODE>never</CODE>.
<P>
<H4><A NAME="SEC102" HREF="emacs_toc.html#SEC102">Automatic Deletion of Backups</A></H4>
<P>
  To prevent unlimited consumption of disk space, Emacs can delete numbered
backup versions automatically.  Generally Emacs keeps the first few backups
and the latest few backups, deleting any in between.  This happens every
time a new backup is made.
<A NAME="IDX468"></A>
<A NAME="IDX469"></A>
<P>
  The two variables <CODE>kept-old-versions</CODE> and
<CODE>kept-new-versions</CODE> control this deletion.  Their values are,
respectively the number of oldest (lowest-numbered) backups to keep and
the number of newest (highest-numbered) ones to keep, each time a new
backup is made.  Recall that these values are used just after a new
backup version is made; that newly made backup is included in the count
in <CODE>kept-new-versions</CODE>.  By default, both variables are 2.
<A NAME="IDX470"></A>
<P>
  If <CODE>trim-versions-without-asking</CODE> is non-<CODE>nil</CODE>, the excess
middle versions are deleted without a murmur.  If it is <CODE>nil</CODE>, the
default, then you are asked whether the excess middle versions should
really be deleted.
<P>
  Dired's <KBD>.</KBD> (Period) command can also be used to delete old versions.
See section <A HREF="emacs_32.html#SEC272">Deleting Files with Dired</A>.
<P>
<H4><A NAME="SEC103" HREF="emacs_toc.html#SEC103">Copying vs. Renaming</A></H4>
<P>
  Backup files can be made by copying the old file or by renaming it.  This
makes a difference when the old file has multiple names.  If the old file
is renamed into the backup file, then the alternate names become names for
the backup file.  If the old file is copied instead, then the alternate
names remain names for the file that you are editing, and the contents
accessed by those names will be the new contents.
<P>
  The method of making a backup file may also affect the file's owner
and group.  If copying is used, these do not change.  If renaming is used,
you become the file's owner, and the file's group becomes the default
(different operating systems have different defaults for the group).
<P>
  Having the owner change is usually a good idea, because then the owner
always shows who last edited the file.  Also, the owners of the backups
show who produced those versions.  Occasionally there is a file whose
owner should not change; it is a good idea for such files to contain
local variable lists to set <CODE>backup-by-copying-when-mismatch</CODE>
locally (see section <A HREF="emacs_35.html#SEC339">Local Variables in Files</A>).
<A NAME="IDX471"></A>
<A NAME="IDX472"></A>
<A NAME="IDX473"></A>
<P>
  The choice of renaming or copying is controlled by three variables.
Renaming is the default choice.  If the variable
<CODE>backup-by-copying</CODE> is non-<CODE>nil</CODE>, copying is used.  Otherwise,
if the variable <CODE>backup-by-copying-when-linked</CODE> is non-<CODE>nil</CODE>,
then copying is used for files that have multiple names, but renaming
may still used when the file being edited has only one name.  If the
variable <CODE>backup-by-copying-when-mismatch</CODE> is non-<CODE>nil</CODE>, then
copying is used if renaming would cause the file's owner or group to
change.
<P>
<H3><A NAME="SEC104" HREF="emacs_toc.html#SEC104">Protection against Simultaneous Editing</A></H3>
<A NAME="IDX474"></A>
<A NAME="IDX475"></A>
<P>
  Simultaneous editing occurs when two users visit the same file, both
make changes, and then both save them.  If nobody were informed that
this was happening, whichever user saved first would later find that his
changes were lost.  On some systems, Emacs notices immediately when the
second user starts to change the file, and issues an immediate warning.
<P>
  For the sake of systems where that is not possible, and in case
someone else proceeds to change the file despite the warning, Emacs also
checks when the file is saved, and issues a second warning if you are
about to overwrite a file containing another user's changes.  You can
prevent loss of the other user's work by taking the proper corrective
action at that time.
<A NAME="IDX476"></A>
<A NAME="IDX477"></A>
<P>
  When you make the first modification in an Emacs buffer that is visiting
a file, Emacs records that  the file is <DFN>locked</DFN> by you.  (It does this by
writing another file in a directory reserved for this purpose.)  The lock
is removed when you save the changes.  The idea is that the file is locked
whenever an Emacs buffer visiting it has unsaved changes.
<A NAME="IDX478"></A>
<P>
  If you begin to modify the buffer while the visited file is locked by
someone else, this constitutes a <DFN>collision</DFN>.  When Emacs detects a
collision, it asks you what to do, by calling the Lisp function
<CODE>ask-user-about-lock</CODE>.  You can redefine this function for the sake
of customization.  The standard definition of this function asks you a
question and accepts three possible answers:
<P>
<DL COMPACT>
<DT><KBD>s</KBD>
<DD>Steal the lock.  Whoever was already changing the file loses the lock,
and you gain the lock.
<DT><KBD>p</KBD>
<DD>Proceed.  Go ahead and edit the file despite its being locked by someone else.
<DT><KBD>q</KBD>
<DD>Quit.  This causes an error (<CODE>file-locked</CODE>) and the modification you
were trying to make in the buffer does not actually take place.
</DL>
<P>
  Note that locking works on the basis of a file name; if a file has
multiple names, Emacs does not realize that the two names are the same file
and cannot prevent two users from editing it simultaneously under different
names.  However, basing locking on names means that Emacs can interlock the
editing of new files that will not really exist until they are saved.
<P>
  Some systems are not configured to allow Emacs to make locks.  On
these systems, Emacs cannot detect trouble in advance, but it still can
detect the collision when you try to save a file and overwrite someone
else's changes.
<P>
  Every time Emacs saves a buffer, it first checks the last-modification
date of the existing file on disk to verify that it has not changed since the
file was last visited or saved.  If the date does not match, it implies
that changes were made in the file in some other way, and these changes are
about to be lost if Emacs actually does save.  To prevent this, Emacs
prints a warning message and asks for confirmation before saving.
Occasionally you will know why the file was changed and know that it does
not matter; then you can answer <KBD>yes</KBD> and proceed.  Otherwise, you should
cancel the save with <KBD>C-g</KBD> and investigate the situation.
<P>
  The first thing you should do when notified that simultaneous editing has
already taken place is to list the directory with <KBD>C-u C-x C-d</KBD>
(see section <A HREF="emacs_19.html#SEC124">Listing a File Directory</A>).  This  shows the file's current
author.  You should attempt to contact him to warn him not to continue
editing.  Often the next step is to save the contents of your Emacs buffer
under a different name, and use <CODE>diff</CODE> to compare the two
files.<P>
  Simultaneous editing checks are also made when you visit with <KBD>C-x
C-f</KBD> a file that is already visited and when you start to modify a
file.  This is not strictly necessary, but it can cause you to find out
about the collision earlier, when perhaps correction takes less work.
<P>
<A NAME="IDX479"></A>
<A NAME="IDX480"></A>
<H2><A NAME="SEC105" HREF="emacs_toc.html#SEC105">Reverting a Buffer</A></H2>
<P>
  If you have made extensive changes to a file and then change your mind
about them, you can get rid of them by reading in the previous version of
the file.  To do this, use <KBD>M-x revert-buffer</KBD>, which operates on the
current buffer.  Since this is a very dangerous thing to do, you must
confirm it with <KBD>yes</KBD>.
<P>
  <CODE>revert-buffer</CODE> keeps point at the same distance (measured in
characters) from the beginning of the file.  If the file was edited only
slightly, you will be at approximately the same piece of text after
reverting as before.  If you have made drastic changes, the same value of
point in the old file may address a totally different piece of text.
<P>
  Reverting marks the buffer as "not modified" until another change is
made.
<P>
  Some kinds of buffers whose contents reflect data bases other than files,
such as Dired buffers, can also be reverted.  For them, reverting means
recalculating their contents from the appropriate data base.  Buffers
created randomly with <KBD>C-x b</KBD> cannot be reverted; <CODE>revert-buffer</CODE>
reports an error when asked to do so.
<P>
<A NAME="IDX481"></A>
<A NAME="IDX482"></A>
<A NAME="IDX483"></A>
<H2><A NAME="SEC106" HREF="emacs_toc.html#SEC106">Auto-Saving: Protection Against Disasters</A></H2>
<P>
  Emacs saves all the visited files from time to time (based on counting
your keystrokes) without being asked.  This is called <DFN>auto-saving</DFN>.
It prevents you from losing more than a limited amount of work if the
system crashes.
<P>
  When Emacs determines that it is time for auto-saving, each buffer is
considered, and is auto-saved if auto-saving is turned on for it and it has
been changed since the last time it was auto-saved.  If any auto-saving is
done, the message <SAMP>`Auto-saving...'</SAMP> is displayed in the echo area until
auto-saving is finished.  Errors occurring during auto-saving are caught
so that they do not interfere with the execution of commands you have been
typing.
<P>
<H3><A NAME="SEC107" HREF="emacs_toc.html#SEC107">Auto-Save Files</A></H3>
<P>
  Auto-saving does not normally save in the files that you visited, because
it can be very undesirable to save a program that is in an inconsistent
state when you have made half of a planned change.  Instead, auto-saving
is done in a different file called the <DFN>auto-save file</DFN>, and the
visited file is changed only when you request saving explicitly (such as
with <KBD>C-x C-s</KBD>).
<P>
  Normally, the auto-save file name is made by appending <SAMP>`#'</SAMP> to the
front and rear of the visited file name.  Thus, a buffer visiting file
<TT>`foo.c'</TT> is auto-saved in a file <TT>`#foo.c#'</TT>.  Most buffers that
are not visiting files are auto-saved only if you request it explicitly;
when they are auto-saved, the auto-save file name is made by appending
<SAMP>`#%'</SAMP> to the front and <SAMP>`#'</SAMP> to the rear of buffer name.  For
example, the <SAMP>`*mail*'</SAMP> buffer in which you compose messages to be
sent is auto-saved in a file named <TT>`#%*mail*#'</TT>.  Auto-save file
names are made this way unless you reprogram parts of Emacs to do
something different (the functions <CODE>make-auto-save-file-name</CODE> and
<CODE>auto-save-file-name-p</CODE>).  The file name to be used for auto-saving
in a buffer is calculated when auto-saving is turned on in that buffer.
<A NAME="IDX484"></A>
<P>
  If you want auto-saving to be done in the visited file, set the variable
<CODE>auto-save-visited-file-name</CODE> to be non-<CODE>nil</CODE>.  In this mode,
there is really no difference between auto-saving and explicit saving.
<A NAME="IDX485"></A>
<P>
  A buffer's auto-save file is deleted when you save the buffer in its
visited file.  To inhibit this, set the variable <CODE>delete-auto-save-files</CODE>
to <CODE>nil</CODE>.  Changing the visited file name with <KBD>C-x C-w</KBD> or
<CODE>set-visited-file-name</CODE> renames any auto-save file to go with
the new visited name.
<P>
  When you delete a large amount of a buffer's text, auto-saving turns
off in that buffer.  This is because if you deleted the text
unintentionally, you might find the auto-save file more useful if it
contains the deleted text.  To restart auto-saving in that buffer, use
<KBD>M-x auto-save</KBD> with a positive argument.
<P>
<H3><A NAME="SEC108" HREF="emacs_toc.html#SEC108">Controlling Auto-Saving</A></H3>
<A NAME="IDX486"></A>
<A NAME="IDX487"></A>
<P>
  Each time you visit a file, auto-saving is turned on for that file's
buffer if the variable <CODE>auto-save-default</CODE> is non-<CODE>nil</CODE> (but not
in batch mode; see section <A HREF="emacs_7.html#SEC17">Entering and Exiting Emacs</A>).  The default for this variable is
<CODE>t</CODE>, so auto-saving is the usual practice for file-visiting buffers.
Auto-saving can be turned on or off for any existing buffer with the
command <KBD>M-x auto-save-mode</KBD>.  Like other minor mode commands, <KBD>M-x
auto-save-mode</KBD> turns auto-saving on with a positive argument, off with a
zero or negative argument; with no argument, it toggles.
<A NAME="IDX488"></A>
<P>
  Emacs does auto-saving periodically based on counting how many characters
you have typed since the last time auto-saving was done.  The variable
<CODE>auto-save-interval</CODE> specifies how many characters there are between
auto-saves.  By default, it is 300.
<A NAME="IDX489"></A>
<P>
  Auto-saving also takes place when you stop typing for a while.  The
variable <CODE>auto-save-timeout</CODE> says how many seconds Emacs should
wait before it does an auto save (and perhaps also a garbage
collection).  (The actual time period is longer if the current buffer is
long; this is a heuristic which aims to keep out of your way when you
are editing long buffers in which auto-save takes an appreciable amount
of time.)  Auto-saving during idle periods accomplishes two things:
first, it makes sure all your work is saved if you go away from the
terminal for a while; second, it may avoid some auto-saving while you
are actually typing.
<P>
  Emacs also does auto-saving whenever it gets a fatal error.  This
includes killing the Emacs job with a shell command such as <CODE>kill
%emacs</CODE>, or disconnecting a phone line or network connection.
<A NAME="IDX490"></A>
<P>
  You can request an auto-save explicitly with the command <KBD>M-x
do-auto-save</KBD>.
<P>
<H3><A NAME="SEC109" HREF="emacs_toc.html#SEC109">Recovering Data from Auto-Saves</A></H3>
<A NAME="IDX491"></A>
<P>
  The way to use the contents of an auto-save file to recover from a loss
of data is with the command <KBD>M-x recover-file <KBD>RET</KBD> <VAR>file</VAR>
<KBD>RET</KBD></KBD>.  This visits <VAR>file</VAR> and then (after your confirmation)
restores the contents from from its auto-save file <TT>`#<VAR>file</VAR>#'</TT>.  You
can then save with <KBD>C-x C-s</KBD> to put the recovered text into <VAR>file</VAR>
itself.  For example, to recover file <TT>`foo.c'</TT> from its auto-save file
<TT>`#foo.c#'</TT>, do:<P>
<PRE>
M-x recover-file <KBD>RET</KBD> foo.c <KBD>RET</KBD>
yes <KBD>RET</KBD>
C-x C-s
</PRE>
<P>
  Before asking for confirmation, <KBD>M-x recover-file</KBD> displays a
directory listing describing the specified file and the auto-save file,
so you can compare their sizes and dates.  If the auto-save file
is older, <KBD>M-x recover-file</KBD> does not offer to read it.
<P>
<H2><A NAME="SEC110" HREF="emacs_toc.html#SEC110">File Name Aliases</A></H2>
<P>
  Symbolic links and hard links both make it possible for several file
names to refer to the same file.  For example, when <TT>`foo'</TT> is a
symbolic link to <TT>`bar'</TT>, the file has two names, but <TT>`bar'</TT> is
the real name, and <TT>`foo'</TT> is just an alias.  More complex cases
occur when symbolic links point to directories.
<P>
  If you visit two names for the same file, normally Emacs makes
two different buffers, but it warns you about the situation.
<A NAME="IDX492"></A>
<P>
  If you wish to avoid visiting the same file in two buffers under
different names, set the variable <CODE>find-file-existing-other-name</CODE>
to a non-<CODE>nil</CODE> value.  Then <CODE>find-file</CODE> uses the existing
buffer visiting the file, no matter which of the file's names you
specify.
<A NAME="IDX493"></A>
<A NAME="IDX494"></A>
<A NAME="IDX495"></A>
<P>
  If the variable <CODE>find-file-visit-truename</CODE> is non-<CODE>nil</CODE>,
then the file name recorded for a buffer is the file's <DFN>truename</DFN>
(made by replacing all symbolic links with their target names), rather
than the name you specify.  Setting <CODE>find-file-visit-truename</CODE> also
implies the effect of <CODE>find-file-existing-other-name</CODE>.
<P>
<A NAME="IDX496"></A>
<H2><A NAME="SEC111" HREF="emacs_toc.html#SEC111">Version Control</A></H2>
<P>
  <DFN>Version control systems</DFN> are packages that can record multiple
versions of a source file, usually storing the unchanged parts of the
file just once.  Version control systems also record history information
such as the creation time of each version, who created it, and a 
description of what was changed in that version.
<P>
  The GNU project recommends the version control system known as RCS,
which is free software and available from the Free Software Foundation.
Emacs supports use of either RCS or SCCS (a proprietary, but widely
used, version control system that is not quite as powerful as RCS)
through a facility called VC.  The same Emacs commands work with either
RCS or SCCS, so you hardly have to know which one of them you are
using.
<P>
<H3><A NAME="SEC112" HREF="emacs_toc.html#SEC112">Concepts of Version Control</A></H3>
<A NAME="IDX497"></A>
<A NAME="IDX498"></A>
<A NAME="IDX499"></A>
<A NAME="IDX500"></A>
<A NAME="IDX501"></A>
<P>
   When a file is under version control, we also say that it is
<DFN>registered</DFN> in the version control system.  Each registered file
has a corresponding <DFN>master file</DFN> which represents the file's
present state plus its change history, so that you can reconstruct from
it either the current version or any specified earlier version.  Usually
the master file also records a <DFN>log entry</DFN> for each version describing
what was changed in that version.
<P>
  The file that is maintained under version control is sometimes called
the <DFN>work file</DFN> corresponding to its master file.
<A NAME="IDX502"></A>
<A NAME="IDX503"></A>
<A NAME="IDX504"></A>
<P>
   To examine a file, you <DFN>check it out</DFN>.  This extracts a version
of the source file (typically, the most recent) from the master file.
If you want to edit the file, you must check it out <DFN>locked</DFN>.  Only
one user can do this at a time for any given source file.  (This kind 
of locking is completely unrelated to the locking that Emacs uses to
detect simultaneous editing of a file.)
<P>
  When you are done with your editing, you must <DFN>check in</DFN> the new
version.  This records the new version in the master file, and unlocks
the source file so that other people can lock it and thus modify it.
<P>
  Checkin and checkout are the basic operations of version control.  You
can do both of them with a single Emacs command: <KBD>C-x C-q</KBD>
(<CODE>vc-toggle-read-only</CODE>).
<P>
<H3><A NAME="SEC113" HREF="emacs_toc.html#SEC113">Editing with Version Control</A></H3>
<P>
  When you visit a file that is maintained using version control, the
mode line displays <SAMP>`RCS'</SAMP> or <SAMP>`SCCS'</SAMP> to inform you that version
control is in use, and also (in case you care) which low-level system
the file is actually stored in.  Normally, such a source file is
read-only, and the mode line indicates this with <SAMP>`%%'</SAMP>.  With RCS,
the mode line also indicates the number of the head version, which is
normally also the version you are looking at.
<P>
  These are the commands for editing a file maintained with
version control:
<P>
<DL COMPACT>
<DT><KBD>C-x C-q</KBD>
<DD>Check the visited file in or out.
<P>
<DT><KBD>C-x v u</KBD>
<DD>Revert the buffer and the file to the last checked in version.
<P>
<DT><KBD>C-x v c</KBD>
<DD>Remove the last-entered change from the master for the visited file.
This undoes your last check-in.
<P>
<DT><KBD>C-x v i</KBD>
<DD>Register the visited file in version control.
</DL>
<P>
(<KBD>C-x v</KBD> is the prefix key for version control commands; all of these
commands except for <KBD>C-x C-q</KBD> start with <KBD>C-x v</KBD>.)
<A NAME="IDX505"></A>
<P>
  When you want to modify a file maintained with version control, type
<KBD>C-x C-q</KBD> (<CODE>vc-toggle-read-only</CODE>).  This <DFN>checks out</DFN> the
file, and tells RCS or SCCS to lock the file.  This means making the
file writable for you (but not for anyone else).
<A NAME="IDX506"></A>
<P>
  When you are finished editing the file, type <KBD>C-x C-q</KBD> again.
When used on a file that is checked out, this command checks the file
in.  But check-in does not start immediately; first, you must enter the
<DFN>log entry</DFN>---a description of the changes in the new version.
<KBD>C-x C-q</KBD> pops up a buffer for you to enter this in.  When you are
finished typing in the log entry, type <KBD>C-c C-c</KBD> to terminate it; this is
when actual check-in takes place.
<P>
  Once you have checked in your changes, the file is unlocked, so that
other users can lock it and modify it.
<A NAME="IDX507"></A>
<P>
  Emacs does not save backup files for source files that are maintained
with version control.  If you want to make backup files despite version
control, set the variable <CODE>vc-make-backup-files</CODE> to a
non-<CODE>nil</CODE> value.
<A NAME="IDX508"></A>
<P>
  Normally the work file exists all the time, whether it is locked or
not.  If you set <CODE>vc-keep-workfiles</CODE> to <CODE>nil</CODE>, then checking
in a new version with <KBD>C-x C-q</KBD> deletes the work file; but any
attempt to visit the file with Emacs creates it again.
<P>
  It is not impossible to lock a file that someone else has locked.  If
you try to check out a file that is locked, <KBD>C-x C-q</KBD> asks you
whether you want to "steal the lock."  If you say yes, the file
becomes locked by you, but a message is sent to the person who had
formerly locked the file, to inform him of what has happened.  The mode
line indicates that a file is locked by someone else by displaying the
login name of that person, before the version number.
<A NAME="IDX509"></A>
<A NAME="IDX510"></A>
<P>
  If you want to discard your current set of changes and revert to the
last version checked in, use <KBD>C-x v u</KBD> (<CODE>vc-revert-buffer</CODE>).
This cancels your last check-out, leaving the file unlocked.  If you want
to make a different set of changes, you must first check the file out
again.  <KBD>C-x v u</KBD> requires confirmation, unless it sees that 
you haven't made any changes since the last checked-in version.
<P>
  <KBD>C-x v u</KBD> is also the command to use if you lock a file and then
don't actually change it.
<A NAME="IDX511"></A>
<A NAME="IDX512"></A>
<P>
  You can cancel a change after checking it in, with <KBD>C-x v c</KBD>
(<CODE>vc-cancel-version</CODE>).  This command discards all record of the
most recent checked in version, so be careful about using it.  It
requires confirmation with <KBD>yes</KBD>.  By default, <KBD>C-x v c</KBD> reverts
your workfile and buffer to the previous version (the one that precedes
the version that is deleted), but you can prevent the reversion by
giving the command a prefix argument.  Then the buffer does not change.
<P>
  This command with a prefix argument is useful when you have checked in
a change and then discover a trivial error in it; you can cancel the
erroneous check-in, fix the error, and repeat the check-in.
<P>
  Be careful when invoking <KBD>C-x v c</KBD>, as it is easy to throw away a
lot of work with it.  To help you be careful, this command always asks
for confirmation with <SAMP>`yes'</SAMP>.
<A NAME="IDX513"></A>
<A NAME="IDX514"></A>
<A NAME="IDX515"></A>
<P>
  You can register the visited file for version control using
<KBD>C-x v i</KBD> (<CODE>vc-register</CODE>).  If the variable
<CODE>vc-default-back-end</CODE> is non-<CODE>nil</CODE>, it specifies which
version control system to use; otherwise, this uses RCS if it is
installed on your system and SCCS if not.  After <KBD>C-x v i</KBD>,
the file is unlocked and read-only.  Type <KBD>C-x C-q</KBD> if you wish to
edit it.
<P>
  By default, the initial version number is 1.1.  If you want to use a
different number, give <KBD>C-x v i</KBD> a prefix argument; then it reads
the initial version number using the minibuffer.
<A NAME="IDX516"></A>
<P>
  If <CODE>vc-initial-comment</CODE> is non-<CODE>nil</CODE>, <KBD>C-x v i</KBD> reads
an initial comment (much like a log entry) to describe the purpose of
this source file.
<A NAME="IDX517"></A>
<A NAME="IDX518"></A>
<P>
  To specify the version number for a subsequent checkin, use the
command <KBD>C-u C-x v v</KBD>.  <KBD>C-x v v</KBD> (<CODE>vc-next-action</CODE>) is the
command that <KBD>C-x C-q</KBD> uses to do the "real work" when the visited
file uses version control.  When used for checkin, and given a prefix
argument, it reads the version number with the minibuffer.
<P>
<H3><A NAME="SEC114" HREF="emacs_toc.html#SEC114">Variables Affecting Check-in and Check-out</A></H3>
<A NAME="IDX519"></A>
<P>
  If <CODE>vc-suppress-confirm</CODE> is non-<CODE>nil</CODE>, then <KBD>C-x C-q</KBD>
and <KBD>C-x v i</KBD> can save the current buffer without asking, and
<KBD>C-x v u</KBD> also operates without asking for confirmation.
(This variable does not affect <KBD>C-x v c</KBD>; that is so drastic
that it should always ask for confirmation.)
<A NAME="IDX520"></A>
<P>
  VC mode does much of its work by running the shell commands for RCS
and SCCS.  If <CODE>vc-command-messages</CODE> is non-<CODE>nil</CODE>, VC displays
messages to indicate which shell commands it runs, and additional
messages when the commands finish.
<P>
  Normally, VC assumes that it can deduce the locked/unlocked state of
files by looking at the file permissions of the work file; this is
fast.  However, if the <TT>`RCS'</TT> or <TT>`SCCS'</TT> subdirectory is
actually a symbolic link, then VC does not trust the file permissions to
reflect this status.
<A NAME="IDX521"></A>
<P>
You can specify the criterion for whether to trust the file permissions
by setting the variable <CODE>vc-mistrust-permissions</CODE>.  Its value may
be <CODE>t</CODE> (always mistrust the file permissions and check the master
file), <CODE>nil</CODE> (always trust the file permissions), or a function of
one argument which makes the decision.  The argument is the directory
name of the <TT>`RCS'</TT> or <TT>`SCCS'</TT> subdirectory.  A non-<CODE>nil</CODE>
value from the function says to mistrust the file permissions.
<P>
  If you find that the file permissions of work files are changed
erroneously, set <CODE>vc-mistrust-permissions</CODE> to <CODE>t</CODE>.  Then VC
always checks the master file to determine the file's status.
<A NAME="IDX522"></A>
<P>
  You can specify additional directories to search for version control
programs by setting the variable <CODE>vc-path</CODE>.  These directories
are searched before the usual search path.  The proper result usually
happens automatically.
<P>
<H3><A NAME="SEC115" HREF="emacs_toc.html#SEC115">Log Entries</A></H3>
<P>
  When you're editing an initial comment or log entry for inclusion in a
master file, finish your entry by typing <KBD>C-c C-c</KBD>.
<P>
<DL COMPACT>
<DT><KBD>C-c C-c</KBD>
<DD>Finish the comment edit normally (<CODE>vc-finish-logentry</CODE>).
This finishes check-in.
</DL>
<P>
  To abort check-in, just don't type <KBD>C-c C-c</KBD> in that buffer.  You
can switch buffers and do other editing.  As long as you don't try to
check in another file, the entry you were editing remains in its
buffer, and you can go back to that buffer at any time to complete the
check-in.
<P>
  If you change several source files for the same reason, it is often
convenient to specify the same log entry for many of the files.  To do
this, use the history of previous log entries.  The commands <KBD>M-n</KBD>,
<KBD>M-p</KBD>, <KBD>M-s</KBD> and <KBD>M-r</KBD> for doing this work just like the
minibuffer history commands (except that these versions are used outside
the minibuffer).
<A NAME="IDX523"></A>
<P>
  Each time you check in a file, the log entry buffer is put into VC Log
mode, which involves running two hooks: <CODE>text-mode-hook</CODE> and
<CODE>vc-log-mode-hook</CODE>.  See section <A HREF="emacs_35.html#SEC337">Hooks</A>.
<P>
<H3><A NAME="SEC116" HREF="emacs_toc.html#SEC116">Change Logs and VC</A></H3>
<P>
  If you use RCS for a program and also maintain a change log file for
it (see section <A HREF="emacs_26.html#SEC193">Change Logs</A>), you can generate change log entries
automatically from the version control log entries:
<P>
<DL COMPACT>
<A NAME="IDX524"></A>
<A NAME="IDX525"></A>
<DT><KBD>C-x v a</KBD>
<DD>Visit the current directory's change log file and create new entries for
versions checked in since the most recent entry in the change log file
(<CODE>vc-update-change-log</CODE>).
<P>
This command works with RCS only; it does not work with SCCS.
</DL>
<P>
  For example, suppose the first line of <TT>`ChangeLog'</TT> is dated 10
April 1992, and that the only check-in since then was by Nathaniel
Bowditch to <TT>`rcs2log'</TT> on 8 May 1992 with log text <SAMP>`Ignore log
messages that start with `#'.'</SAMP>.  Then <KBD>C-x v a</KBD> visits
<TT>`ChangeLog'</TT> and inserts text like this:
<P>
<PRE>
Fri May  8 21:45:00 1992  Nathaniel Bowditch  (nat@apn.org)

        * rcs2log: Ignore log messages that start with `#'.
</PRE>
<P>
You can then edit the new change log entry further as you wish.
<P>
  Normally, the log entry for file <TT>`foo'</TT> is displayed as <SAMP>`*
foo: <VAR>text of log entry</VAR>'</SAMP>.  The <SAMP>`:'</SAMP> after <TT>`foo'</TT> is omitted
if the text of the log entry starts with <SAMP>`(<VAR>functionname</VAR>):
'</SAMP>.  For example, if the log entry for <TT>`vc.el'</TT> is
<SAMP>`(vc-do-command): Check call-process status.'</SAMP>, then the text in
<TT>`ChangeLog'</TT> looks like this:
<P>
<PRE>
Wed May  6 10:53:00 1992  Nathaniel Bowditch  (nat@apn.org)

        * vc.el (vc-do-command): Check call-process status.
</PRE>
<P>
  When <KBD>C-x v a</KBD> adds several change log entries at once, it groups
related log entries together if they all are checked in by the same
author at nearly the same time.  If the log entries for several such
files all have the same text, it coalesces them into a single entry.
For example, suppose the most recent checkins have the following log
entries:
<P>
<PRE>
For <TT>`vc.texinfo'</TT>:
Fix expansion typos.
For <TT>`vc.el'</TT>:
Don't call expand-file-name.
For <TT>`vc-hooks.el'</TT>:
Don't call expand-file-name.
</PRE>
<P>
  They appear like this in <TT>`ChangeLog'</TT>:
<P>
<PRE>
Wed Apr  1 08:57:59 1992  Nathaniel Bowditch  (nat@apn.org)

        * vc.texinfo: Fix expansion typos.

        * vc.el, vc-hooks.el: Don't call expand-file-name.
</PRE>
<P>
  Normally, <KBD>C-x v a</KBD> separates log entries by a blank line, but you
can mark several related log entries to be clumped together (without an
intervening blank line) by starting the text of each related log entry
with a label of the form <SAMP>`{<VAR>clumpname</VAR>} '</SAMP>.  The label
itself is not copied to <TT>`ChangeLog'</TT>.  For example, suppose the log
entries are:
<P>
<PRE>
For <TT>`vc.texinfo'</TT>:
{expand} Fix expansion typos.
For <TT>`vc.el'</TT>:
{expand} Don't call expand-file-name.
For <TT>`vc-hooks.el'</TT>:
{expand} Don't call expand-file-name.
</PRE>
<P>
Then the text in <TT>`ChangeLog'</TT> looks like this:
<P>
<PRE>
Wed Apr  1 08:57:59 1992  Nathaniel Bowditch  (nat@apn.org)

        * vc.texinfo: Fix expansion typos.
        * vc.el, vc-hooks.el: Don't call expand-file-name.
</PRE>
<P>
  A log entry whose text begins with <SAMP>`#'</SAMP> is not copied to
<TT>`ChangeLog'</TT>.  For example, if you merely fix some misspellings in
comments, you can log the change with an entry beginning with <SAMP>`#'</SAMP>
to avoid putting such trivia into <TT>`ChangeLog'</TT>.
<P>
<H3><A NAME="SEC117" HREF="emacs_toc.html#SEC117">Examining And Comparing Old Versions</A></H3>
<P>
<DL COMPACT>
<DT><KBD>C-x v ~ <VAR>version</VAR> <KBD>RET</KBD></KBD>
<DD>Examine version <VAR>version</VAR> of the visited file, in a buffer of its
own (<CODE>vc-version-other-window</CODE>).
<P>
<DT><KBD>C-x v =</KBD>
<DD>Compare the current buffer contents with the latest checked-in version
of the file.
<P>
<DT><KBD>C-u C-x v = <VAR>file</VAR> <KBD>RET</KBD> <VAR>oldvers</VAR> <KBD>RET</KBD> <VAR>newvers</VAR> <KBD>RET</KBD></KBD>
<DD>Compare the specified two versions of <VAR>file</VAR>.
</DL>
<A NAME="IDX526"></A>
<A NAME="IDX527"></A>
<P>
  You can examine any version of a file by first visiting it, and then
using <KBD>C-x v ~ <VAR>version</VAR> <KBD>RET</KBD></KBD>
(<CODE>vc-version-other-window</CODE>).  This puts the text of version
<VAR>version</VAR> in a file named <TT>`<VAR>filename</VAR>.~<VAR>version</VAR>~'</TT>,
then visits it in a separate window.
<A NAME="IDX528"></A>
<A NAME="IDX529"></A>
<P>
  To compare two versions of a file, use the command <KBD>C-x v =</KBD>
(<CODE>vc-diff</CODE>).
<P>
  Plain <KBD>C-x v =</KBD> compares the current buffer contents (saving them
in the file if necessary) with the last checked-in version of the file.
With a prefix argument, <KBD>C-x v =</KBD> reads a file name and two version
numbers, then compares those versions of the specified file.
<P>
  If you supply a directory name instead of the name of a work file,
this command compares the two specified versions of all registered files
in that directory and its subdirectories.  You can also specify a
snapshot name (see section <A HREF="emacs_19.html#SEC120">Snapshots</A>) instead of one or both version
numbers.
<P>
  You can specify a checked-in version by its number; you can specify
the most recent checked-in version with an empty version number.
<P>
  This command works by running the <CODE>diff</CODE> utility, getting the
options from the variable <CODE>diff-switches</CODE>.  It displays the output
in a special buffer in another window.  Unlike the <KBD>M-x diff</KBD>
command, <KBD>C-x v =</KBD> does not try to find the changes in the old and
new versions.  This is because one or both versions normally do not
exist as files.  They exist only in the records of the master file.
See section <A HREF="emacs_19.html#SEC125">Comparing Files</A>, for more information about <KBD>M-x diff</KBD>.
<P>
<H3><A NAME="SEC118" HREF="emacs_toc.html#SEC118">VC Status Commands</A></H3>
<A NAME="IDX530"></A>
<A NAME="IDX531"></A>
<P>
  To view the detailed version control status and history of a file,
type <KBD>C-x v l</KBD> (<CODE>vc-print-log</CODE>).  It displays the history of
changes to the current file, including the text of the log entries.  The
output appears in a separate window.
<A NAME="IDX532"></A>
<A NAME="IDX533"></A>
<P>
  When you are working on a large program, it's often useful to find all
the files that are currently locked, or all the files maintained in
version control at all.  You can use <KBD>C-x v d</KBD> (<CODE>vc-directory</CODE>)
to show all the locked files in or beneath the current directory.  This
includes all files that are locked by any user.  <KBD>C-u C-x v d</KBD> lists
all files in or beneath the current directory that are maintained with
version control.
<P>
  The list of files is displayed as a buffer that uses an augmented
Dired mode.  The names of the users locking various files are shown (in
parentheses) in place of the owner and group.  All the normal Dired
commands work in this buffer.  Most interactive VC commands work also,
and apply to the file name on the current line.
<P>
  The <KBD>C-x v v</KBD> command (<CODE>vc-next-action</CODE>), when used in the
augmented Dired buffer, operates on all the marked files (or the file on
the current line).  If it operates on more than one file, it handles
each file according to its current state; thus, it may check out one
file and check in another (because it is already checked out).  If it
has to check in any files, it reads a single log entry, then uses that
text for all the files being checked in.  This can be convenient for
registering or checking in several files at once, as part of the same
change.
<P>
<H3><A NAME="SEC119" HREF="emacs_toc.html#SEC119">Renaming VC Work Files and Master Files</A></H3>
<A NAME="IDX534"></A>
<P>
  When you rename a registered file, you must also rename its master
file correspondingly to get proper results.  Use <CODE>vc-rename-file</CODE>
to rename the source file as you specify, and rename its master file
accordingly.  It also updates any snapshots (see section <A HREF="emacs_19.html#SEC120">Snapshots</A>) that
mention the file, so that they use the new name; despite this, the
snapshot thus modified may not completely work (see section <A HREF="emacs_19.html#SEC122">Snapshot Caveats</A>).
<P>
  You cannot use <CODE>vc-rename-file</CODE> on a file that is locked by
someone else.
<P>
<A NAME="IDX535"></A>
<H3><A NAME="SEC120" HREF="emacs_toc.html#SEC120">Snapshots</A></H3>
<P>
  A <DFN>snapshot</DFN> is a named set of file versions (one for each
registered file) that you can treat as a unit.  One important kind of
snapshot is a <DFN>release</DFN>, a (theoretically) stable version of the
system that is ready for distribution to users.
<P>
<H4><A NAME="SEC121" HREF="emacs_toc.html#SEC121">Making and Using Snapshots</A></H4>
<P>
  There are two basic commands for snapshots; one makes a
snapshot with a given name, the other retrieves a named snapshot.
<P>
<A NAME="IDX536"></A>
<A NAME="IDX537"></A>
<DL COMPACT>
<DT><CODE>C-x v s <VAR>name</VAR> <KBD>RET</KBD></CODE>
<DD>Define the last saved versions of every registered file in or under the
current directory as a snapshot named <VAR>name</VAR>
(<CODE>vc-create-snapshot</CODE>).
<A NAME="IDX538"></A>
<A NAME="IDX539"></A>
<P>
<DT><CODE>C-x v r <VAR>name</VAR> <KBD>RET</KBD></CODE>
<DD>Check out all registered files at or below the current directory level
using whatever versions correspond to the snapshot <VAR>name</VAR>
(<CODE>vc-retrieve-snapshot</CODE>).
<P>
This command reports an error if any files are locked at or below the
current directory, without changing anything; this is to avoid
overwriting work in progress.
</DL>
<P>
  A snapshot uses a very small amount of resources--just enough to record
the list of file names and which version belongs to the snapshot.  Thus,
you need not hesitate to create snapshots whenever they are useful.
<P>
  You can give a snapshot name as an argument to <KBD>C-x v =</KBD> or
<KBD>C-x v ~</KBD> (see section <A HREF="emacs_19.html#SEC117">Examining And Comparing Old Versions</A>).  Thus, you can use it to compare a
snapshot against the current files, or two snapshots against each other,
or a snapshot against a named version.
<P>
<H4><A NAME="SEC122" HREF="emacs_toc.html#SEC122">Snapshot Caveats</A></H4>
<A NAME="IDX540"></A>
<P>
VC's snapshot facilities are modeled on RCS's named-configuration
support.  They use RCS's native facilities for this, so under VC
snapshots made using RCS are visible even when you bypass VC.
<P>
For SCCS, VC implements snapshots itself.  The files it uses contain
name/file/version-number triples.  These snapshots are visible only
through VC.
<P>
  File renaming and deletion can create some difficulties with snapshots.
This is not a VC-specific problem, but a general design issue in version
control systems that no one has solved very well yet.
<P>
  If you rename a registered file, you need to rename its master along
with it (the command <CODE>vc-rename-file</CODE> does this automatically).  If
you are using SCCS, you must also update the records of the snapshot, to
mention the file by its new name (<CODE>vc-rename-file</CODE> does this,
too).  An old snapshot that refers to a master file that no longer
exists under the recorded name is invalid; VC can no longer retrieve
it.  It would be beyond the scope of this manual to explain enough about
RCS and SCCS to explain how to update the snapshots by hand.
<P>
  Using <CODE>vc-rename-file</CODE> makes the snapshot remain valid for
retrieval, but it does not solve all problems.  For example, some of the
files in the program probably refer to others by name.  At the very
least, the makefile probably mentions the file that you renamed.  If you
retrieve an old snapshot, the renamed file is retrieved under its new
name, which is not the name that the makefile expects.  So the program
won't really work as retrieved.
<P>
<H3><A NAME="SEC123" HREF="emacs_toc.html#SEC123">Inserting Version Control Headers</A></H3>
<P>
   Sometimes it is convenient to put version identification strings
directly into working files.  Certain special strings called
<DFN>version headers</DFN> are replaced in each successive version by the
number of that version.
<A NAME="IDX541"></A>
<A NAME="IDX542"></A>
<P>
  You can use the <KBD>C-x v h</KBD> command (<CODE>vc-insert-headers</CODE>) to
insert a suitable header string.
<P>
<DL COMPACT>
<DT><KBD>C-x v h</KBD>
<DD>Insert headers in a file for use with your version-control system.
</DL>
<A NAME="IDX543"></A>
<P>
  The default header string is <SAMP>`$Id$'</SAMP> for RCS and <SAMP>`%W%'</SAMP> for
SCCS.  You can specify other headers to insert by setting the variable
<CODE>vc-header-alist</CODE>.  Its value is a list of elements of the form
<CODE>(<VAR>program</VAR> . <VAR>string</VAR>)</CODE> where <VAR>program</VAR> is <CODE>RCS</CODE>
or <CODE>SCCS</CODE> and <VAR>string</VAR> is the string to use.
<P>
  Instead of a single string, you can specify a list of strings; then
each string in the list is inserted as a separate header on a line of
its own.
<P>
  It is often necessary to use "superfluous" backslashes when writing
the strings that you put in this variable.  This is to prevent the
string in the constant from being interpreted as a header itself if the
Emacs Lisp file containing it is maintained with version control.
<A NAME="IDX544"></A>
<P>
  Each header is inserted surrounded by tabs, inside comment delimiters,
on a new line at the start of the buffer.  Normally the ordinary comment
start and comment end strings of the current mode are used, but for
certain modes, there are special comment delimiters for this purpose;
the variable <CODE>vc-comment-alist</CODE> specifies them.  Each element of
this list has the form <CODE>(<VAR>mode</VAR> <VAR>starter</VAR> <VAR>ender</VAR>)</CODE>.
<A NAME="IDX545"></A>
<P>
  The variable <CODE>vc-static-header-alist</CODE> specifies further strings
to add based on the name of the buffer.  Its value should be a list of
elements of the form <CODE>(<VAR>regexp</VAR> . <VAR>format</VAR>)</CODE>.  Whenever
<VAR>regexp</VAR> matches the buffer name, <VAR>format</VAR> is inserted as part
of the header.  A header line is inserted for each element that matches
the buffer name, and for each string specified by
<CODE>vc-header-alist</CODE>.  The header line is made by processing the
string from <CODE>vc-header-alist</CODE> with the format taken from the
element.  The default value for <CODE>vc-static-header-alist</CODE> is:
<P>
<PRE>
(("\\.c$" .
  "\n#ifndef lint\nstatic char vcid[] = \"\%s\";\n\
#endif /* lint */\n"))
</PRE>
<P>
which specifies insertion of a string of this form:
<P>
<PRE>

#ifndef lint
static char vcid[] = "<VAR>string</VAR>";
#endif /* lint */
</PRE>
<P>
<H2><A NAME="SEC124" HREF="emacs_toc.html#SEC124">Listing a File Directory</A></H2>
<A NAME="IDX546"></A>
<A NAME="IDX547"></A>
<P>
  The file system groups files into <DFN>directories</DFN>.  A <DFN>directory
listing</DFN> is a list of all the files in a directory.  Emacs provides
directory listings in brief format (file names only) and verbose format
(sizes, dates, and authors included).
<P>
<DL COMPACT>
<DT><KBD>C-x C-d <VAR>dir-or-pattern</VAR></KBD>
<DD>Print a brief directory listing (<CODE>list-directory</CODE>).
<DT><KBD>C-u C-x C-d <VAR>dir-or-pattern</VAR></KBD>
<DD>Print a verbose directory listing.
</DL>
<A NAME="IDX548"></A>
<A NAME="IDX549"></A>
<P>
  The command to display a directory listing is <KBD>C-x C-d</KBD>
(<CODE>list-directory</CODE>).  It reads using the minibuffer a file name
which is either a directory to be listed or a wildcard-containing
pattern for the files to be listed.  For example,
<P>
<PRE>
C-x C-d /u2/emacs/etc <KBD>RET</KBD>
</PRE>
<P>
lists all the files in directory <TT>`/u2/emacs/etc'</TT>.  An example of
specifying a file name pattern is
<P>
<PRE>
C-x C-d /u2/emacs/src/*.c <KBD>RET</KBD>
</PRE>
<P>
  Normally, <KBD>C-x C-d</KBD> prints a brief directory listing containing just
file names.  A numeric argument (regardless of value) tells it to print a
verbose listing (like <SAMP>`ls -l'</SAMP>).
<A NAME="IDX550"></A>
<A NAME="IDX551"></A>
<P>
  The text of a directory listing is obtained by running <CODE>ls</CODE> in an
inferior process.  Two Emacs variables control the switches passed to
<CODE>ls</CODE>: <CODE>list-directory-brief-switches</CODE> is a string giving the
switches to use in brief listings (<CODE>"-CF"</CODE> by default), and
<CODE>list-directory-verbose-switches</CODE> is a string giving the switches to
use in a verbose listing (<CODE>"-l"</CODE> by default).
<P>
<A NAME="IDX552"></A>
<H2><A NAME="SEC125" HREF="emacs_toc.html#SEC125">Comparing Files</A></H2>
<A NAME="IDX553"></A>
<A NAME="IDX554"></A>
<P>
  The command <KBD>M-x diff</KBD> compares two files, displaying the
differences in an Emacs buffer named <SAMP>`*Diff*'</SAMP>.  It works by running
the <CODE>diff</CODE> program, using options taken from the variable
<CODE>diff-switches</CODE>, whose value should be a string.
<P>
  The buffer <SAMP>`*Diff*'</SAMP> has Compilation mode as its major mode, so
you can use <KBD>C-x `</KBD> to visit successive changed locations in the two
source files.  You can also move to a particular hunk of changes and
type <KBD>C-c C-c</KBD> to find the corresponding source location.  You can
also use the other special commands of Compilation mode: <KBD>SPC</KBD> and
<KBD>DEL</KBD> for scrolling, and <KBD>M-p</KBD> and <KBD>M-n</KBD> for cursor motion.
See section <A HREF="emacs_27.html#SEC225">Running `make', or Compilers Generally</A>.
<A NAME="IDX555"></A>
<P>
  The command <KBD>M-x diff-backup</KBD> compares a specified file with its most
recent backup.  If you specify the name of a backup file,
<CODE>diff-backup</CODE> compares it with the source file that it is a backup
of.
<A NAME="IDX556"></A>
<A NAME="IDX557"></A>
<P>
  The command <KBD>M-x compare-windows</KBD> compares the text in the current
window with that in the next window.  Comparison starts at point in each
window.  Point moves forward in each window, a character at a time in each
window, until the next characters in the two windows are different.  Then
the command is finished.  For more information about windows in Emacs,
section <A HREF="emacs_21.html#SEC133">Multiple Windows</A>.
<A NAME="IDX558"></A>
<P>
  With a numeric argument, <CODE>compare-windows</CODE> ignores changes in
whitespace.  If the variable <CODE>compare-ignore-case</CODE> is
non-<CODE>nil</CODE>, it ignores differences in case as well.
<P>
  See also section <A HREF="emacs_26.html#SEC202">Merging Files with Emerge</A>, for convenient facilities for merging two
similar files.
<P>
<H2><A NAME="SEC126" HREF="emacs_toc.html#SEC126">Miscellaneous File Operations</A></H2>
<P>
  Emacs has commands for performing many other operations on files.
All operate on one file; they do not accept wild card file names.
<A NAME="IDX559"></A>
<A NAME="IDX560"></A>
<A NAME="IDX561"></A>
<P>
  <KBD>M-x view-file</KBD> allows you to scan or read a file by sequential
screenfuls.  It reads a file name argument using the minibuffer.  After
reading the file into an Emacs buffer, <CODE>view-file</CODE> displays the
beginning.  You can then type <KBD>SPC</KBD> to scroll forward one windowful,
or <KBD>DEL</KBD> to scroll backward.  Various other commands are provided
for moving around in the file, but none for changing it; type <KBD>C-h</KBD>
while viewing for a list of them.  They are mostly the same as normal
Emacs cursor motion commands.  To exit from viewing, type <KBD>C-c</KBD>.
The commands for viewing are defined by a special major mode called View
mode.
<P>
  A related command, <KBD>M-x view-buffer</KBD>, views a buffer already present
in Emacs.  See section <A HREF="emacs_20.html#SEC130">Miscellaneous Buffer Operations</A>.
<A NAME="IDX562"></A>
<P>
  <KBD>M-x insert-file</KBD> inserts a copy of the contents of the specified
file into the current buffer at point, leaving point unchanged before the
contents and the mark after them.
<A NAME="IDX563"></A>
<P>
  <KBD>M-x write-region</KBD> is the inverse of <KBD>M-x insert-file</KBD>; it
copies the contents of the region into the specified file.  <KBD>M-x
append-to-file</KBD> adds the text of the region to the end of the specified
file.  See section <A HREF="emacs_14.html#SEC62">Accumulating Text</A>.
<A NAME="IDX564"></A>
<A NAME="IDX565"></A>
<P>
  <KBD>M-x delete-file</KBD> deletes the specified file, like the <CODE>rm</CODE>
command in the shell.  If you are deleting many files in one directory, it
may be more convenient to use Dired (see section <A HREF="emacs_32.html#SEC269">Dired, the Directory Editor</A>).
<A NAME="IDX566"></A>
<P>
  <KBD>M-x rename-file</KBD> reads two file names <VAR>old</VAR> and <VAR>new</VAR> using
the minibuffer, then renames file <VAR>old</VAR> as <VAR>new</VAR>.  If a file named
<VAR>new</VAR> already exists, you must confirm with <KBD>yes</KBD> or renaming is not
done; this is because renaming causes the old meaning of the name <VAR>new</VAR>
to be lost.  If <VAR>old</VAR> and <VAR>new</VAR> are on different file systems, the
file <VAR>old</VAR> is copied and deleted.
<A NAME="IDX567"></A>
<P>
  The similar command <KBD>M-x add-name-to-file</KBD> is used to add an
additional name to an existing file without removing its old name.
The new name must belong on the same file system that the file is on.
<A NAME="IDX568"></A>
<A NAME="IDX569"></A>
<P>
  <KBD>M-x copy-file</KBD> reads the file <VAR>old</VAR> and writes a new file named
<VAR>new</VAR> with the same contents.  Confirmation is required if a file named
<VAR>new</VAR> already exists, because copying has the consequence of overwriting
the old contents of the file <VAR>new</VAR>.
<A NAME="IDX570"></A>
<P>
  <KBD>M-x make-symbolic-link</KBD> reads two file names <VAR>old</VAR> and
<VAR>linkname</VAR>, then creates a symbolic link named <VAR>linkname</VAR> and
pointing at <VAR>old</VAR>.  The effect is that future attempts to open file
<VAR>linkname</VAR> will refer to whatever file is named <VAR>old</VAR> at the
time the opening is done, or will get an error if the name <VAR>old</VAR> is
not in use at that time.  This command does not expand the argument
<VAR>filename</VAR>, so that it allows you to specify a relative name
as the target of the link.
<P>
  Confirmation is required when creating the link if <VAR>linkname</VAR> is
in use.  Note that not all systems support symbolic links.
<P>Go to the <A HREF="emacs_18.html">previous</A>, <A HREF="emacs_20.html">next</A> section.<P>
